/**
  Set flex column width.
  @param {Number} $columns Number of columns.
  @param {String} $gutter-width Value for width of column gutters.
  @param {String} $item-min-width Value to set a minimum column width.
 */
@mixin set-flex-columns($columns: 1, $item-min-width: false) {
  flex-basis: auto;
  flex-grow: 0;
  flex-shrink: 0;
  margin-block-end: var(--gutter-width);
  margin-inline: calc(var(--gutter-width) / 2);
  @if $item-min-width {
    min-width: $item-min-width;
  }
  width: calc(1 / $columns * 100% - var(--gutter-width));
}

/**
  Set flex grid layout.
  @param {Number} $columns Number of columns.
  @param {String} $gutter-width Pixel value for width of column gutters.
  @param {String} $item-min-width Pixel value to set a minimum column width.
 */
@mixin flex-grid($columns: 1, $item-min-width: 300px) {
  display: flex;
  flex-wrap: wrap;
  margin-inline: calc(var(--gutter-width) / -2);

  > * {
    @include set-flex-column($columns, $item-min-width);
  }
}

/**
  Remove flex constrains and margins.
  CSS grid reset for flex parent and children items.
 */
@mixin css-grid-reset {
  margin-inline: 0;

  > * {
    margin: 0;
    min-width: 0;
    width: 100%;
  }
}

/**
  Set auto fit grid template.
  @param {String} $item-min-width Minimum column width.
  @param {String} $gutter-width Optional width of column and row gutters.
  @param {Boolean} $flex-override Whether to set override for grid cells.
 */
@mixin set-css-autofit-columns($item-min-width, $flex-override: false) {
  gap: var(--gutter-width);
  grid-template-columns: repeat(auto-fit, minmax(#{$item-min-width}, 1fr));

  @if $flex-override {
    > * {
      margin: 0;
      min-width: 0;
      width: 100%;
    }
  }
}

/**
  Set fixed grid template.
  @param {Number} $columns Number of columns.
  @param {String} $gutter-width Optional width of row and column gutters.
  @param {Boolean} $flex-override Whether to set override for grid cells.
 */
@mixin set-css-fixed-columns($columns, $flex-override: false) {
  grid-template-columns: repeat($columns, 1fr);

  @if $flex-override {
    > * {
      margin: 0;
      min-width: 0;
      width: 100%;
    }
  }
}

/**
  Create auto fit grid.
  @param {String} $item-min-width Minimum column width.
  @param {String} $gutter-width Width of column gutters.
  @param {Boolean} $flex-override Whether to reset styling to remove flex constrains first.
 */
@mixin css-autofit-grid($item-min-width: rem(300px), $flex-override: false) {
  @if $flex-override {
    @include css-grid-reset();
  }
  @include set-css-autofit-columns($item-min-width);
  display: grid;
}

/**
  Create auto fit grid.
  @param {String} $item-min-width Minimum column width.
  @param {String} $gutter-width Width of column gutters.
  @param {Boolean} $flex-override Whether to reset styling to remove flex constrains first.
 */
@mixin css-fixed-grid($columns: 1, $flex-override: false) {
  @if $flex-override {
    @include css-grid-reset();
  }
  @include set-css-fixed-columns($columns, false);
  display: grid;
  gap: var(--gutter-width);
}
